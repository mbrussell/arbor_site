{"title":"Stratifying the number of plots to measure in a forest carbon inventory","markdown":{"yaml":{"title":"Stratifying the number of plots to measure in a forest carbon inventory","description":"How to allocate field plots to measure forest carbon under a stratified random sampling framework.","author":"Matt Russell","date":"2023-09-22","slug":[],"categories":["Sampling"],"tags":["sampling","forestsamplr","forest inventory","carbon","forest carbon"],"image":"inventory_eqpt.jpg"},"headingText":"Small","containsRefs":false,"markdown":"\n\n![](inventory_eqpt.jpg){width=500px}\n</center>\nForest inventories that measure carbon, like any forest attribute, are conducted to obtain a precise estimate of a population mean. Forest carbon inventories can cost a lot of time and effort. Their high costs have been cited as a barrier for some landowners to enter carbon programs. \n\nUntil remote sensing technologies are adopted at scale to monitor and report carbon, field based inventories will continue to be relied on the estimate forest carbon and their associated attributes. Fortunately, stratified random sampling is an efficient field sampling methodology that can save time and effort in the field. \n\nIf we know the size of a number of subpopulations that are a part of a larger population (e.g., an ownership seeking to enroll in a carbon project), we can use stratified random sampling to efficiently measure attributes like forest carbon. If these subpopulations, or strata, have different mean values and smaller variances relative to the population mean, stratified random sampling is generally preferred over simple random sampling. This ultimately results in a narrower confidence interval for an overall population estimate, even when using the same sample size.\n\nThis post will describe a way to allocate field plots to measure forest carbon under a stratified random sampling framework.\n \n```{r, echo = F, warning = F, message = F}\nlibrary(tidyverse)\nlibrary(kableExtra)\n```\n\n```{r, echo = F}\n#See here for general statistics used in this analysis (adapted slightly): https://apps.fs.usda.gov/fiadb-api/fullreport?rselected=Forest%20type%20group&cselected=Stand-size%20class&sdenom=2&snum=55&wc=232021\nmetric_ton_convert <- 0.907185\nplots_all <- 1116\nall_se <- 0.32    \nall_sd <- all_se*sqrt(plots_all)\n\n#13.0637*metric_ton_convert\nplots_small = 396\nsmall_se <- 0.39    \nsmall_sd <- small_se*sqrt(plots_small)\n\n# Medium\n#21.8263*metric_ton_convert\t\nplots_med = 468\nmed_se <- 0.3850253 \nmed_sd <- med_se*sqrt(plots_med)\n\n# Large\n#30.2494*metric_ton_convert\nplots_large = 347\nlarge_se <- 0.6287748 \nlarge_sd <- large_se*sqrt(plots_large)\n```\n\n# Maine property with spruce/fir forest\n\nFor this example, a 200-acre ownership located in Maine seeks to enroll in a carbon project. It requires a precise estimate of the total carbon in aboveground and belowground portions of live trees. The property is a spruce/fir forest type.\n\nSome previous data were collected from a pilot study across the property. Foresters measured 20 1/10th-acre plots across the property and found the average carbon storage to be 21.2 metric tonnes of carbon per acre with a standard deviation of 10.7.\n\nForesters also recorded the stand size class of each plot they visited. These were categorized with stands containing primarily small- (<5 inches), medium (5-10 inches), or large-diameter trees (> 10 inches). For each stand size class, we can calculate the standard deviation from our pilot study. Using remote sensing, the foresters were able to distinguish how many acres were found in each of these stand size classes across the property.\n\n```{r, echo = F}\nstratum <- tribble(\n  ~`Stand size class`, ~`Stratum area (acres)`, ~`SD (metric tons/acre)`, ~`Area x SD`,\n  \"Small diameter (< 5 in)\", 65, 7.8, 507,\n  \"Medium diameter (5 - 10 in)\", 77, 8.3, 639,\n  \"Large diameter (> 10 in)\", 58, 11.7, 679\n)\n```\n\n```{r, echo = F}\nknitr::kable((stratum[,]), \n             caption = 'Example stratum for a forest carbon inventory in a spruce/fir forest in Maine.') %>% \n   kable_styling(bootstrap_options = \"bordered\",\n                full_width = FALSE)\n```\n\nFor those of you that may want to perform these calculations in R, the data table named **stratum** compiles the data in a usable format:\n\n```{r}\nlibrary(tidyverse)\n\nstratum <- tribble(\n  ~`Stand size class`, ~`Stratum area (acres)`, ~`SD (metric tons/acre)`, ~`Area x SD`,\n  \"Small diameter (< 5 in)\", 65, 7.8, 507,\n  \"Medium diameter (5 - 10 in)\", 77, 8.3, 639,\n  \"Large diameter (> 10 in)\", 58, 11.7, 679\n)\n```\n\n# Allocating field plots to stratum\n\nI've written about the benefits of stratified random sampling [in the past](https://arbor-analytics.com/post/stratified-vs-simple-random-sampling-fun-with-forestsamplr/). And I encourage you to see [the forestsampler package](https://github.com/ncx-co/forestsamplr) developed by NCX for other great functions related to generating estimates for a variety of forest sampling methods.\n\nKnowing what we now know about the variability within each strata on the Maine property, we could allocate the number of field plots to each stand in a few different ways. Described in Burkhart et al.’s [*Forest Measurements*](https://www.waveland.com/browse.php?t=668&r=a), there are two common ways to allocate field plots in a stratified random sample: through **proportional** or **optimal allocation**.\n\n## Proportional allocation\n\nSay our analysis indicates we need to collect data from 100 new inventory plots to achieve a desired level of precision (e.g., to be within 5% of the mean carbon storage). Proportional allocation would distribute the 100 field plots according to their total area. That is, we can collect more field plots in larger-size strata. The following R function named `allocate()` can determine the appropriate number of desired plots to collect in each stratum. We'll round up the number of plots with the `ceiling()` function to make sure we measure an entire plot: \n\n```{r}\nallocate <- function(acres.stratum, total.acres, total.plots){\n  num.plots = ceiling((acres.stratum / total.acres) * total.plots)\n  return(num.plots)\n  }\n```\n\nWe can apply the function to the **stratum** data frame:\n\n```{r}\nallocate(acres.stratum = stratum$`Stratum area (acres)`,\n         total.acres = sum(stratum$`Stratum area (acres)`),\n         total.plots = 100)\n```\n\nSo, the proportional allocation method indicates we should collect 33, 39, and 29 plots in the small-, medium-, and large-diameter stands, respectively. Because more acreage is found in medium-sized trees, we collect more plots there.  \n\n## Optimal allocation\n\nThe optimal allocation method distributes the 100 field plots to each stratum that provides the smallest amount of variability possible. In addition to the total area, also required in this calculation is the standard deviation of carbon found within each stratum. The total number of plots to sample in each stratum would be represented by the stratum area multiplied by the standard deviation of carbon, as seen in the table above. The `Area x SD` variable can be input into the `allocate()` function to determine the appropriate number of plots to collect with optimal allocation:\n\n```{r}\nallocate(acres.stratum = stratum$`Area x SD`,\n         total.acres = sum(stratum$`Area x SD`),\n         total.plots = 100)\n```\n\nSo, the optimal allocation method indicates we should collect 28, 36, and 38 plots in the small-, medium-, and large-diameter stands, respectively. In other words, because the stand deviation of carbon is lower in the small- and medium-diameter stands, we can focus our sampling in the large-diameter stands where there is more variability in carbon. The optimal strategy indicates sampling three fewer plots in the medium-diameter stands compared to the proportional allocation method, even though it’s the stand with the largest area.\n\n```{r, echo = F}\nstratum_summ <- tribble(\n  ~`Stand size class`, ~`Stratum area (acres)`, ~`SD (metric tons/acre)`, ~`Area x SD`, ~`Plots to measure - proportional`, ~`Plots to measure - optimal`,\n  \"Small diameter (< 5 in)\", 65, 7.8, 507, 33, 28,\n  \"Medium diameter (5 - 10 in)\", 77, 8.3, 639, 39, 36,\n  \"Large diameter (> 10 in)\", 58, 11.7, 679, 29, 38,\n  \"SUM\", 200, NA, 1825, 100, 100\n)\n\n``` \n\n```{r, echo = F}\nknitr::kable((stratum_summ[,]), \n             caption = 'Distribution of plots to sample for proportional and optimal allocation methods.') %>% \n   kable_styling(bootstrap_options = \"bordered\",\n                full_width = FALSE)\n```\n\nThere is a lot more that goes into planning a forest carbon inventory, but understanding how many plots to measure and where to measure them is an important first step. Using stratified random sampling is an efficient approach to determine a precise estimate of forest carbon. \n\n--\n\n*Special thanks to Micky Allen for catching an error in the numbers of plots in Table 2.*\n\n*By Matt Russell. [Email Matt](mailto:matt@arbor-analytics.com) with any questions or comments.*","srcMarkdownNoYaml":"\n# \n\n![](inventory_eqpt.jpg){width=500px}\n</center>\n#  \nForest inventories that measure carbon, like any forest attribute, are conducted to obtain a precise estimate of a population mean. Forest carbon inventories can cost a lot of time and effort. Their high costs have been cited as a barrier for some landowners to enter carbon programs. \n\nUntil remote sensing technologies are adopted at scale to monitor and report carbon, field based inventories will continue to be relied on the estimate forest carbon and their associated attributes. Fortunately, stratified random sampling is an efficient field sampling methodology that can save time and effort in the field. \n\nIf we know the size of a number of subpopulations that are a part of a larger population (e.g., an ownership seeking to enroll in a carbon project), we can use stratified random sampling to efficiently measure attributes like forest carbon. If these subpopulations, or strata, have different mean values and smaller variances relative to the population mean, stratified random sampling is generally preferred over simple random sampling. This ultimately results in a narrower confidence interval for an overall population estimate, even when using the same sample size.\n\nThis post will describe a way to allocate field plots to measure forest carbon under a stratified random sampling framework.\n \n```{r, echo = F, warning = F, message = F}\nlibrary(tidyverse)\nlibrary(kableExtra)\n```\n\n```{r, echo = F}\n#See here for general statistics used in this analysis (adapted slightly): https://apps.fs.usda.gov/fiadb-api/fullreport?rselected=Forest%20type%20group&cselected=Stand-size%20class&sdenom=2&snum=55&wc=232021\nmetric_ton_convert <- 0.907185\nplots_all <- 1116\nall_se <- 0.32    \nall_sd <- all_se*sqrt(plots_all)\n\n# Small\n#13.0637*metric_ton_convert\nplots_small = 396\nsmall_se <- 0.39    \nsmall_sd <- small_se*sqrt(plots_small)\n\n# Medium\n#21.8263*metric_ton_convert\t\nplots_med = 468\nmed_se <- 0.3850253 \nmed_sd <- med_se*sqrt(plots_med)\n\n# Large\n#30.2494*metric_ton_convert\nplots_large = 347\nlarge_se <- 0.6287748 \nlarge_sd <- large_se*sqrt(plots_large)\n```\n\n# Maine property with spruce/fir forest\n\nFor this example, a 200-acre ownership located in Maine seeks to enroll in a carbon project. It requires a precise estimate of the total carbon in aboveground and belowground portions of live trees. The property is a spruce/fir forest type.\n\nSome previous data were collected from a pilot study across the property. Foresters measured 20 1/10th-acre plots across the property and found the average carbon storage to be 21.2 metric tonnes of carbon per acre with a standard deviation of 10.7.\n\nForesters also recorded the stand size class of each plot they visited. These were categorized with stands containing primarily small- (<5 inches), medium (5-10 inches), or large-diameter trees (> 10 inches). For each stand size class, we can calculate the standard deviation from our pilot study. Using remote sensing, the foresters were able to distinguish how many acres were found in each of these stand size classes across the property.\n\n```{r, echo = F}\nstratum <- tribble(\n  ~`Stand size class`, ~`Stratum area (acres)`, ~`SD (metric tons/acre)`, ~`Area x SD`,\n  \"Small diameter (< 5 in)\", 65, 7.8, 507,\n  \"Medium diameter (5 - 10 in)\", 77, 8.3, 639,\n  \"Large diameter (> 10 in)\", 58, 11.7, 679\n)\n```\n\n```{r, echo = F}\nknitr::kable((stratum[,]), \n             caption = 'Example stratum for a forest carbon inventory in a spruce/fir forest in Maine.') %>% \n   kable_styling(bootstrap_options = \"bordered\",\n                full_width = FALSE)\n```\n\nFor those of you that may want to perform these calculations in R, the data table named **stratum** compiles the data in a usable format:\n\n```{r}\nlibrary(tidyverse)\n\nstratum <- tribble(\n  ~`Stand size class`, ~`Stratum area (acres)`, ~`SD (metric tons/acre)`, ~`Area x SD`,\n  \"Small diameter (< 5 in)\", 65, 7.8, 507,\n  \"Medium diameter (5 - 10 in)\", 77, 8.3, 639,\n  \"Large diameter (> 10 in)\", 58, 11.7, 679\n)\n```\n\n# Allocating field plots to stratum\n\nI've written about the benefits of stratified random sampling [in the past](https://arbor-analytics.com/post/stratified-vs-simple-random-sampling-fun-with-forestsamplr/). And I encourage you to see [the forestsampler package](https://github.com/ncx-co/forestsamplr) developed by NCX for other great functions related to generating estimates for a variety of forest sampling methods.\n\nKnowing what we now know about the variability within each strata on the Maine property, we could allocate the number of field plots to each stand in a few different ways. Described in Burkhart et al.’s [*Forest Measurements*](https://www.waveland.com/browse.php?t=668&r=a), there are two common ways to allocate field plots in a stratified random sample: through **proportional** or **optimal allocation**.\n\n## Proportional allocation\n\nSay our analysis indicates we need to collect data from 100 new inventory plots to achieve a desired level of precision (e.g., to be within 5% of the mean carbon storage). Proportional allocation would distribute the 100 field plots according to their total area. That is, we can collect more field plots in larger-size strata. The following R function named `allocate()` can determine the appropriate number of desired plots to collect in each stratum. We'll round up the number of plots with the `ceiling()` function to make sure we measure an entire plot: \n\n```{r}\nallocate <- function(acres.stratum, total.acres, total.plots){\n  num.plots = ceiling((acres.stratum / total.acres) * total.plots)\n  return(num.plots)\n  }\n```\n\nWe can apply the function to the **stratum** data frame:\n\n```{r}\nallocate(acres.stratum = stratum$`Stratum area (acres)`,\n         total.acres = sum(stratum$`Stratum area (acres)`),\n         total.plots = 100)\n```\n\nSo, the proportional allocation method indicates we should collect 33, 39, and 29 plots in the small-, medium-, and large-diameter stands, respectively. Because more acreage is found in medium-sized trees, we collect more plots there.  \n\n## Optimal allocation\n\nThe optimal allocation method distributes the 100 field plots to each stratum that provides the smallest amount of variability possible. In addition to the total area, also required in this calculation is the standard deviation of carbon found within each stratum. The total number of plots to sample in each stratum would be represented by the stratum area multiplied by the standard deviation of carbon, as seen in the table above. The `Area x SD` variable can be input into the `allocate()` function to determine the appropriate number of plots to collect with optimal allocation:\n\n```{r}\nallocate(acres.stratum = stratum$`Area x SD`,\n         total.acres = sum(stratum$`Area x SD`),\n         total.plots = 100)\n```\n\nSo, the optimal allocation method indicates we should collect 28, 36, and 38 plots in the small-, medium-, and large-diameter stands, respectively. In other words, because the stand deviation of carbon is lower in the small- and medium-diameter stands, we can focus our sampling in the large-diameter stands where there is more variability in carbon. The optimal strategy indicates sampling three fewer plots in the medium-diameter stands compared to the proportional allocation method, even though it’s the stand with the largest area.\n\n```{r, echo = F}\nstratum_summ <- tribble(\n  ~`Stand size class`, ~`Stratum area (acres)`, ~`SD (metric tons/acre)`, ~`Area x SD`, ~`Plots to measure - proportional`, ~`Plots to measure - optimal`,\n  \"Small diameter (< 5 in)\", 65, 7.8, 507, 33, 28,\n  \"Medium diameter (5 - 10 in)\", 77, 8.3, 639, 39, 36,\n  \"Large diameter (> 10 in)\", 58, 11.7, 679, 29, 38,\n  \"SUM\", 200, NA, 1825, 100, 100\n)\n\n``` \n\n```{r, echo = F}\nknitr::kable((stratum_summ[,]), \n             caption = 'Distribution of plots to sample for proportional and optimal allocation methods.') %>% \n   kable_styling(bootstrap_options = \"bordered\",\n                full_width = FALSE)\n```\n\nThere is a lot more that goes into planning a forest carbon inventory, but understanding how many plots to measure and where to measure them is an important first step. Using stratified random sampling is an efficient approach to determine a precise estimate of forest carbon. \n\n--\n\n*Special thanks to Micky Allen for catching an error in the numbers of plots in Table 2.*\n\n*By Matt Russell. [Email Matt](mailto:matt@arbor-analytics.com) with any questions or comments.*"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.553","theme":{"light":"minty","dark":"slate"},"title-block-banner":true,"title":"Stratifying the number of plots to measure in a forest carbon inventory","description":"How to allocate field plots to measure forest carbon under a stratified random sampling framework.","author":"Matt Russell","date":"2023-09-22","slug":[],"categories":["Sampling"],"tags":["sampling","forestsamplr","forest inventory","carbon","forest carbon"],"image":"inventory_eqpt.jpg"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}